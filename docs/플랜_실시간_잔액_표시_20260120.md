# ì‹¤ì‹œê°„ ì”ì•¡ í‘œì‹œ ë° ìë™ ì—…ë°ì´íŠ¸ ê³„íšì„œ

**ì‘ì„±ì¼**: 2026-01-20
**ë²„ì „**: v7.27.1
**ëª©í‘œ**: ì‹¤ì‹œê°„ ë§¤ë§¤ ì¤‘ í˜„ì¬ ì”ì•¡ í‘œì‹œ + ê±°ë˜ ì™„ë£Œ ì‹œ ìë™ ì—…ë°ì´íŠ¸

---

## ğŸ“‹ í˜„í™© ë¶„ì„

### âœ… ì •ìƒ ì‘ë™ ê¸°ëŠ¥

1. **CapitalManager ì‹œìŠ¤í…œ** (ì™„ë²½)
   - `core/capital_manager.py`: ìë³¸ ê´€ë¦¬ SSOT
   - `get_trade_size()`: í˜„ì¬ ìë³¸ ì¡°íšŒ
   - `update_after_trade(pnl)`: ê±°ë˜ í›„ ìë³¸ ì—…ë°ì´íŠ¸
   - `mode`: compound/fixed ì§€ì›

2. **UnifiedBot í†µí•©** (ì™„ë²½)
   - `self.capital_manager`: CapitalManager ì¸ìŠ¤í„´ìŠ¤
   - `update_capital_for_compounding()`: ê±°ë˜ í›„ ìë™ í˜¸ì¶œ
   - `_get_compound_seed()`: ì‹œë“œ ì¡°íšŒ

3. **UI ìë³¸ ëª¨ë“œ ì„ íƒ** (ì™„ë²½)
   - `mode_combo`: "ğŸ“ˆ ë³µë¦¬ (Compound)" / "ğŸ“Š ê³ ì • (Fixed)"
   - ì„¤ì • ì €ì¥/ë¡œë“œ ì •ìƒ

### âš ï¸ ë¬¸ì œì 

#### 1. **ì‹œë“œ ìë³¸ í•„ë“œê°€ ê³ ì • ì…ë ¥ í•„ë“œ** (Critical)

**ìœ„ì¹˜**: `ui/widgets/trading/live_multi.py` Line 209-216

**í˜„ì¬ ì½”ë“œ**:
```python
# ì‹œë“œ
grid.addWidget(QLabel("ì‹œë“œ ìë³¸:"), row, 2)
self.seed_spin = QDoubleSpinBox()  # âŒ ìˆ˜ì • ê°€ëŠ¥í•œ SpinBox
self.seed_spin.setRange(10, 10000)
self.seed_spin.setValue(100)
self.seed_spin.setPrefix("$")
self.seed_spin.setStyleSheet(BacktestStyles.spin_box())
grid.addWidget(self.seed_spin, row, 3)
```

**ë¬¸ì œ**:
- ì‚¬ìš©ìê°€ ì§ì ‘ ìˆ˜ì •í•˜ì§€ ì•ŠëŠ” í•œ $100 ê³ ì •
- ê±°ë˜ ì™„ë£Œ í›„ì—ë„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
- ì‹¤ì‹œê°„ ì”ì•¡ì„ ì•Œ ìˆ˜ ì—†ìŒ

**ì˜í–¥**:
- ì‚¬ìš©ìê°€ í˜„ì¬ ì”ì•¡ì„ í™•ì¸í•  ìˆ˜ ì—†ìŒ
- ë³µë¦¬ ëª¨ë“œì—¬ë„ UIì— ë°˜ì˜ë˜ì§€ ì•ŠìŒ
- CapitalManagerì™€ UIê°€ ë™ê¸°í™”ë˜ì§€ ì•ŠìŒ

#### 2. **ê±°ë˜ ì™„ë£Œ ì‹œê·¸ë„ ë¯¸ì—°ê²°** (High Priority)

**ìœ„ì¹˜**: `ui/widgets/trading/live_multi.py`

**ë¬¸ì œ**:
- UnifiedBotì˜ `update_capital_for_compounding()` í˜¸ì¶œ ì‹œ UI ì—…ë°ì´íŠ¸ ì—†ìŒ
- ì‹¤ì‹œê°„ ë§¤ë§¤ ìœ„ì ¯ì´ ìë³¸ ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•˜ì§€ ì•ŠìŒ

**ì˜í–¥**:
- ë°±ê·¸ë¼ìš´ë“œì—ì„œëŠ” ìë³¸ì´ ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ UIì— í‘œì‹œ ì•ˆ ë¨

---

## ğŸ¯ ê°œì„  ëª©í‘œ

### Phase 1: UI êµ¬ì¡° ë³€ê²½ (30ë¶„)

**ëª©í‘œ**: ì‹œë“œ ìë³¸ì„ ì½ê¸° ì „ìš© ë¼ë²¨ë¡œ ë³€ê²½ + ì´ˆê¸° ìë³¸ ì…ë ¥ í•„ë“œ ë¶„ë¦¬

**ë³€ê²½ ì‚¬í•­**:

#### Before (í˜„ì¬):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‹œë“œ ìë³¸: [$100 â–²â–¼] (SpinBox, ìˆ˜ì • ê°€ëŠ¥) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### After (ê°œì„ ):
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ˆê¸° ìë³¸: [$100 â–²â–¼] (SpinBox, ì‹œì‘ ì „ì—ë§Œ ìˆ˜ì •)  â”‚
â”‚ í˜„ì¬ ì”ì•¡: $100.00 ğŸ”’ (Label, ì½ê¸° ì „ìš©, ì‹¤ì‹œê°„)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ìƒì„¸ ì„¤ê³„**:

1. **ì´ˆê¸° ìë³¸ í•„ë“œ** (`initial_capital_spin`)
   - QDoubleSpinBox
   - ë§¤ë§¤ ì‹œì‘ ì „ì—ë§Œ ìˆ˜ì • ê°€ëŠ¥
   - ë§¤ë§¤ ì¤‘ì—ëŠ” `setEnabled(False)`ë¡œ ì ê¸ˆ
   - ì´ˆê¸°ê°’: $100

2. **í˜„ì¬ ì”ì•¡ ë¼ë²¨** (`current_balance_label`)
   - QLabel (ì½ê¸° ì „ìš©)
   - ğŸ”’ ì•„ì´ì½˜ + ê¸ˆì•¡ í‘œì‹œ
   - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
   - ìƒ‰ìƒ: ìˆ˜ìµ(ì´ˆë¡), ì†ì‹¤(ë¹¨ê°•), ë™ì¼(íšŒìƒ‰)
   - í˜•ì‹: `"$123.45"` (ì†Œìˆ˜ì  2ìë¦¬)

---

### Phase 2: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì—°ë™ (40ë¶„)

**ëª©í‘œ**: ê±°ë˜ ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ ì”ì•¡ ì—…ë°ì´íŠ¸

**êµ¬í˜„ ë°©ë²•**:

#### A. ì‹œê·¸ë„/ìŠ¬ë¡¯ ì—°ê²°

**ìœ„ì¹˜**: `ui/widgets/trading/live_multi.py`

**ì‹ ê·œ ì‹œê·¸ë„ ì •ì˜**:
```python
class LiveMultiWidget(QWidget):
    # ê¸°ì¡´ ì‹œê·¸ë„
    start_signal = pyqtSignal(dict)
    stop_signal = pyqtSignal()

    # âœ… ì‹ ê·œ ì‹œê·¸ë„ ì¶”ê°€
    balance_updated = pyqtSignal(float)  # ì”ì•¡ ë³€ê²½ ì‹œ ë°œìƒ
```

**ìŠ¬ë¡¯ êµ¬í˜„**:
```python
def _on_balance_updated(self, new_balance: float):
    """ì”ì•¡ ì—…ë°ì´íŠ¸ ìŠ¬ë¡¯"""
    if self.current_balance_label:
        # ìƒ‰ìƒ ê²°ì •
        initial = self.initial_capital_spin.value() if self.initial_capital_spin else 100.0
        if new_balance > initial:
            color = Colors.success  # ì´ˆë¡
        elif new_balance < initial:
            color = Colors.danger   # ë¹¨ê°•
        else:
            color = Colors.text_primary  # íšŒìƒ‰

        # í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        self.current_balance_label.setText(f"${new_balance:,.2f} ğŸ”’")
        self.current_balance_label.setStyleSheet(f"color: {color}; font-weight: {Typography.font_bold};")

        logger.info(f"[LiveMulti] ì”ì•¡ ì—…ë°ì´íŠ¸: ${new_balance:,.2f}")
```

#### B. UnifiedBot í†µí•©

**ìœ„ì¹˜**: `core/unified_bot.py` Line 366-387

**ê¸°ì¡´ ì½”ë“œ**:
```python
def update_capital_for_compounding(self):
    """CapitalManagerë¥¼ í†µí•œ ìë³¸ ì—…ë°ì´íŠ¸"""
    # ... (ê¸°ì¡´ ë¡œì§)
    self.capital_manager.update_after_trade(pnl)
    # âŒ UI ì—…ë°ì´íŠ¸ ì—†ìŒ
```

**ê°œì„  ì½”ë“œ**:
```python
def update_capital_for_compounding(self):
    """CapitalManagerë¥¼ í†µí•œ ìë³¸ ì—…ë°ì´íŠ¸"""
    # ... (ê¸°ì¡´ ë¡œì§)
    self.capital_manager.update_after_trade(pnl)

    # âœ… UI ì—…ë°ì´íŠ¸ ì¶”ê°€
    new_balance = self.capital_manager.current_capital
    if hasattr(self, 'ui_callback') and self.ui_callback:
        self.ui_callback('balance_updated', new_balance)
```

**ì½œë°± ë“±ë¡** (LiveMultiWidget):
```python
def _start_trading(self):
    """ë§¤ë§¤ ì‹œì‘"""
    # ... (ê¸°ì¡´ ì„¤ì •)

    # âœ… UI ì½œë°± ë“±ë¡
    def ui_callback(event_type: str, data):
        if event_type == 'balance_updated':
            self.balance_updated.emit(data)

    # UnifiedBot ìƒì„± ì‹œ ì½œë°± ì „ë‹¬
    # (í–¥í›„ êµ¬í˜„: UnifiedBot.__init__ì— ui_callback íŒŒë¼ë¯¸í„° ì¶”ê°€)
```

#### C. í´ë§ ë°©ì‹ (ê°„ë‹¨í•œ ëŒ€ì•ˆ)

**ë³µì¡í•œ ì½œë°± ëŒ€ì‹  ì£¼ê¸°ì  ì¡°íšŒ**:

```python
from PyQt6.QtCore import QTimer

class LiveMultiWidget(QWidget):
    def __init__(self, parent=None):
        super().__init__(parent)
        # ... (ê¸°ì¡´ ì´ˆê¸°í™”)

        # âœ… ì”ì•¡ ì—…ë°ì´íŠ¸ íƒ€ì´ë¨¸ (1ì´ˆë§ˆë‹¤)
        self.balance_timer = QTimer()
        self.balance_timer.timeout.connect(self._update_balance_display)

    def _start_trading(self):
        """ë§¤ë§¤ ì‹œì‘"""
        # ... (ê¸°ì¡´ ë¡œì§)
        self.balance_timer.start(1000)  # 1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸

    def _stop_trading(self):
        """ë§¤ë§¤ ì¤‘ì§€"""
        # ... (ê¸°ì¡´ ë¡œì§)
        self.balance_timer.stop()

    def _update_balance_display(self):
        """ì”ì•¡ í‘œì‹œ ì—…ë°ì´íŠ¸ (í´ë§)"""
        if not self.is_running:
            return

        # âœ… CapitalManagerì—ì„œ í˜„ì¬ ì”ì•¡ ì¡°íšŒ
        # (í–¥í›„: UnifiedBot ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¤ê¸°)
        # current_balance = self.bot.capital_manager.current_capital

        # ì„ì‹œ: ê±°ë˜ ë‚´ì—­ì—ì„œ ê³„ì‚°
        try:
            from storage.trade_storage import get_trade_storage
            exchange = self.exchange_combo.currentText() if self.exchange_combo else 'bybit'
            symbol = 'BTCUSDT'  # ì„ì‹œ
            storage = get_trade_storage(exchange, symbol)
            stats = storage.get_stats()

            initial = self.initial_capital_spin.value() if self.initial_capital_spin else 100.0
            total_pnl_usd = stats.get('total_pnl_usd', 0)
            current_balance = initial + total_pnl_usd

            # UI ì—…ë°ì´íŠ¸
            self._on_balance_updated(current_balance)

        except Exception as e:
            logger.error(f"[LiveMulti] ì”ì•¡ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")
```

---

### Phase 3: ë³µë¦¬/ê³ ì • ëª¨ë“œ ì—°ë™ (20ë¶„)

**ëª©í‘œ**: ìë³¸ ëª¨ë“œì— ë”°ë¼ ì”ì•¡ í‘œì‹œ ë°©ì‹ ë³€ê²½

**ë³µë¦¬ ëª¨ë“œ** (Compound):
- í˜„ì¬ ì”ì•¡ì´ **ì‹¤ì‹œê°„ìœ¼ë¡œ ì¦ê°€/ê°ì†Œ**
- ë‹¤ìŒ ê±°ë˜ í¬ê¸° = í˜„ì¬ ì”ì•¡

**ê³ ì • ëª¨ë“œ** (Fixed):
- í˜„ì¬ ì”ì•¡ì€ **ëˆ„ì  ì†ìµë§Œ í‘œì‹œ**
- ë‹¤ìŒ ê±°ë˜ í¬ê¸° = ì´ˆê¸° ìë³¸ (ê³ ì •)

**UI í‘œì‹œ ì˜ˆì‹œ**:

```
ğŸ“ˆ ë³µë¦¬ (Compound) ëª¨ë“œ:
    ì´ˆê¸° ìë³¸: $100.00
    í˜„ì¬ ì”ì•¡: $125.30 ğŸ”’  â† ë‹¤ìŒ ê±°ë˜ í¬ê¸°

ğŸ“Š ê³ ì • (Fixed) ëª¨ë“œ:
    ì´ˆê¸° ìë³¸: $100.00  â† ë‹¤ìŒ ê±°ë˜ í¬ê¸°
    ëˆ„ì  ì†ìµ: +$25.30 ğŸ”’
```

**ì½”ë“œ ë³€ê²½**:

```python
def _on_balance_updated(self, new_balance: float):
    """ì”ì•¡ ì—…ë°ì´íŠ¸ ìŠ¬ë¡¯"""
    if not self.current_balance_label:
        return

    initial = self.initial_capital_spin.value() if self.initial_capital_spin else 100.0
    pnl = new_balance - initial

    # ëª¨ë“œ í™•ì¸
    is_compound = self.mode_combo.currentIndex() == 0 if self.mode_combo else True

    # ìƒ‰ìƒ
    color = Colors.success if pnl > 0 else (Colors.danger if pnl < 0 else Colors.text_primary)

    # í…ìŠ¤íŠ¸
    if is_compound:
        # ë³µë¦¬: í˜„ì¬ ì”ì•¡ í‘œì‹œ
        text = f"${new_balance:,.2f} ğŸ”’"
        tooltip = f"ë‹¤ìŒ ê±°ë˜ í¬ê¸°: ${new_balance:,.2f}"
    else:
        # ê³ ì •: ëˆ„ì  ì†ìµ í‘œì‹œ
        text = f"{pnl:+,.2f} ğŸ”’"
        tooltip = f"ë‹¤ìŒ ê±°ë˜ í¬ê¸°: ${initial:,.2f} (ê³ ì •)"

    self.current_balance_label.setText(text)
    self.current_balance_label.setStyleSheet(f"color: {color}; font-weight: {Typography.font_bold};")
    self.current_balance_label.setToolTip(tooltip)
```

---

## ğŸ“ ìƒì„¸ êµ¬í˜„ ê³„íš

### Phase 1: UI êµ¬ì¡° ë³€ê²½

**íŒŒì¼**: `ui/widgets/trading/live_multi.py`

**ìˆ˜ì • ìœ„ì¹˜**: Line 198-224 (`_create_config_group()` ë©”ì„œë“œ)

**ë³€ê²½ ì‚¬í•­**:

#### 1. ì´ˆê¸° ìë³¸ í•„ë“œ ì¶”ê°€

```python
# Line 209-216 (ê¸°ì¡´ ì‹œë“œ í•„ë“œ)
# âŒ ì œê±°: self.seed_spin

# âœ… ì¶”ê°€: ì´ˆê¸° ìë³¸ í•„ë“œ
grid.addWidget(QLabel("ì´ˆê¸° ìë³¸:"), row, 2)
self.initial_capital_spin = QDoubleSpinBox()
self.initial_capital_spin.setRange(10, 100000)
self.initial_capital_spin.setValue(100)
self.initial_capital_spin.setPrefix("$")
self.initial_capital_spin.setSuffix(" (ì‹œì‘ ì „ ìˆ˜ì •)")
self.initial_capital_spin.setStyleSheet(BacktestStyles.spin_box())
self.initial_capital_spin.setToolTip("ë§¤ë§¤ ì‹œì‘ ì „ì—ë§Œ ìˆ˜ì • ê°€ëŠ¥í•©ë‹ˆë‹¤")
grid.addWidget(self.initial_capital_spin, row, 3)
```

#### 2. í˜„ì¬ ì”ì•¡ ë¼ë²¨ ì¶”ê°€

```python
# âœ… ì¶”ê°€: í˜„ì¬ ì”ì•¡ ë¼ë²¨ (ìƒˆë¡œìš´ í–‰)
row += 1
grid.addWidget(QLabel("í˜„ì¬ ì”ì•¡:"), row, 2)
self.current_balance_label = QLabel("$100.00 ğŸ”’")
self.current_balance_label.setStyleSheet(f"""
    color: {Colors.text_primary};
    font-weight: {Typography.font_bold};
    font-size: {Typography.text_base};
    padding: {Spacing.space_2};
    background: {Colors.bg_overlay};
    border-radius: {Radius.radius_sm};
""")
self.current_balance_label.setToolTip("ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì¤‘ (ì½ê¸° ì „ìš©)")
self.current_balance_label.setMinimumWidth(Size.input_min_width)  # 200px
grid.addWidget(self.current_balance_label, row, 3)
```

#### 3. í´ë˜ìŠ¤ ì†ì„± ì¶”ê°€

```python
# Line 108-112 (ê¸°ì¡´ ì†ì„±)
class LiveMultiWidget(QWidget):
    # ... (ê¸°ì¡´ ì‹œê·¸ë„)

    def __init__(self, parent=None):
        super().__init__(parent)

        # âŒ ì œê±°
        # self.seed_spin: Optional[QDoubleSpinBox] = None

        # âœ… ì¶”ê°€
        self.initial_capital_spin: Optional[QDoubleSpinBox] = None
        self.current_balance_label: Optional[QLabel] = None
        self.balance_timer: Optional[QTimer] = None
```

---

### Phase 2: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì—°ë™

**íŒŒì¼**: `ui/widgets/trading/live_multi.py`

**ìˆ˜ì • ìœ„ì¹˜**: Line 324-350 (`_toggle_trading()`, `_start_trading()`, `_stop_trading()`)

**ë³€ê²½ ì‚¬í•­ 1: íƒ€ì´ë¨¸ ì´ˆê¸°í™”**

```python
# Line 130+ (__init__ ë©”ì„œë“œ)
def __init__(self, parent=None):
    super().__init__(parent)
    # ... (ê¸°ì¡´ ì´ˆê¸°í™”)

    # âœ… ì”ì•¡ ì—…ë°ì´íŠ¸ íƒ€ì´ë¨¸ ì´ˆê¸°í™”
    self.balance_timer = QTimer()
    self.balance_timer.timeout.connect(self._update_balance_display)

    self._init_ui()
```

**ë³€ê²½ ì‚¬í•­ 2: ë§¤ë§¤ ì‹œì‘ ì‹œ ì ê¸ˆ**

```python
# Line 340+ (_start_trading ë©”ì„œë“œ)
def _start_trading(self):
    """ë§¤ë§¤ ì‹œì‘"""
    # ... (ê¸°ì¡´ ì„¤ì •)

    # âœ… ì´ˆê¸° ìë³¸ í•„ë“œ ì ê¸ˆ (ë§¤ë§¤ ì¤‘ ìˆ˜ì • ë°©ì§€)
    if self.initial_capital_spin:
        self.initial_capital_spin.setEnabled(False)
        self.initial_capital_spin.setSuffix(" (ë§¤ë§¤ ì¤‘)")

    # âœ… ì”ì•¡ ì—…ë°ì´íŠ¸ íƒ€ì´ë¨¸ ì‹œì‘ (1ì´ˆë§ˆë‹¤)
    if self.balance_timer:
        self.balance_timer.start(1000)

    # âœ… ì´ˆê¸° ì”ì•¡ í‘œì‹œ
    initial = self.initial_capital_spin.value() if self.initial_capital_spin else 100.0
    self._on_balance_updated(initial)

    # ì‹œê·¸ë„ ë°œìƒ
    self.start_signal.emit(self.get_config())
    logger.info("[LiveMulti] ë§¤ë§¤ ì‹œì‘")
```

**ë³€ê²½ ì‚¬í•­ 3: ë§¤ë§¤ ì¤‘ì§€ ì‹œ ì ê¸ˆ í•´ì œ**

```python
# Line 360+ (_stop_trading ë©”ì„œë“œ)
def _stop_trading(self):
    """ë§¤ë§¤ ì¤‘ì§€"""
    # ... (ê¸°ì¡´ ë¡œì§)

    # âœ… ì´ˆê¸° ìë³¸ í•„ë“œ ì ê¸ˆ í•´ì œ
    if self.initial_capital_spin:
        self.initial_capital_spin.setEnabled(True)
        self.initial_capital_spin.setSuffix(" (ì‹œì‘ ì „ ìˆ˜ì •)")

    # âœ… ì”ì•¡ ì—…ë°ì´íŠ¸ íƒ€ì´ë¨¸ ì¤‘ì§€
    if self.balance_timer:
        self.balance_timer.stop()

    # ì‹œê·¸ë„ ë°œìƒ
    self.stop_signal.emit()
    logger.info("[LiveMulti] ë§¤ë§¤ ì¤‘ì§€")
```

**ë³€ê²½ ì‚¬í•­ 4: ì”ì•¡ ì—…ë°ì´íŠ¸ ë©”ì„œë“œ ì¶”ê°€**

```python
# Line 580+ (í´ë˜ìŠ¤ ëë¶€ë¶„, _show_history ì´í›„)
def _update_balance_display(self):
    """ì”ì•¡ í‘œì‹œ ì—…ë°ì´íŠ¸ (1ì´ˆë§ˆë‹¤ í˜¸ì¶œ)"""
    if not self.is_running or not self.current_balance_label:
        return

    try:
        # í˜„ì¬ ê±°ë˜ ë‚´ì—­ì—ì„œ ì´ ì†ìµ ê³„ì‚°
        from storage.trade_storage import get_trade_storage

        # ê±°ë˜ì†Œ/ì‹¬ë³¼ ê°€ì ¸ì˜¤ê¸°
        exchange = self.exchange_combo.currentText() if self.exchange_combo else 'bybit'
        symbol = 'BTCUSDT'  # TODO: ì‹¤ì œ ì‹¬ë³¼ ê°€ì ¸ì˜¤ê¸°

        # ê±°ë˜ ë‚´ì—­ ì¡°íšŒ
        storage = get_trade_storage(exchange, symbol)
        stats = storage.get_stats()

        # ì´ˆê¸° ìë³¸
        initial = self.initial_capital_spin.value() if self.initial_capital_spin else 100.0

        # í˜„ì¬ ì”ì•¡ ê³„ì‚°
        total_pnl_usd = stats.get('total_pnl_usd', 0)
        current_balance = initial + total_pnl_usd

        # UI ì—…ë°ì´íŠ¸
        self._on_balance_updated(current_balance)

    except Exception as e:
        logger.error(f"[LiveMulti] ì”ì•¡ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {e}")

def _on_balance_updated(self, new_balance: float):
    """ì”ì•¡ ì—…ë°ì´íŠ¸ ìŠ¬ë¡¯

    Args:
        new_balance: ìƒˆë¡œìš´ ì”ì•¡ ($)
    """
    if not self.current_balance_label or not self.initial_capital_spin:
        return

    initial = self.initial_capital_spin.value()
    pnl = new_balance - initial

    # ëª¨ë“œ í™•ì¸
    is_compound = self.mode_combo.currentIndex() == 0 if self.mode_combo else True

    # ìƒ‰ìƒ ê²°ì •
    if pnl > 0:
        color = Colors.success  # ì´ˆë¡
    elif pnl < 0:
        color = Colors.danger   # ë¹¨ê°•
    else:
        color = Colors.text_primary  # íšŒìƒ‰

    # í…ìŠ¤íŠ¸ ë° íˆ´íŒ
    if is_compound:
        # ë³µë¦¬: í˜„ì¬ ì”ì•¡ í‘œì‹œ
        text = f"${new_balance:,.2f} ğŸ”’"
        tooltip = f"ë‹¤ìŒ ê±°ë˜ í¬ê¸°: ${new_balance:,.2f}\nëˆ„ì  ì†ìµ: {pnl:+,.2f}"
    else:
        # ê³ ì •: ëˆ„ì  ì†ìµ í‘œì‹œ
        text = f"{pnl:+,.2f} ğŸ”’"
        tooltip = f"ë‹¤ìŒ ê±°ë˜ í¬ê¸°: ${initial:,.2f} (ê³ ì •)\ní˜„ì¬ ì”ì•¡: ${new_balance:,.2f}"

    # UI ì—…ë°ì´íŠ¸
    self.current_balance_label.setText(text)
    self.current_balance_label.setStyleSheet(f"""
        color: {color};
        font-weight: {Typography.font_bold};
        font-size: {Typography.text_base};
        padding: {Spacing.space_2};
        background: {Colors.bg_overlay};
        border-radius: {Radius.radius_sm};
    """)
    self.current_balance_label.setToolTip(tooltip)
```

---

### Phase 3: ì„¤ì • ì €ì¥/ë¡œë“œ ì—…ë°ì´íŠ¸

**íŒŒì¼**: `ui/widgets/trading/live_multi.py`

**ìˆ˜ì • ìœ„ì¹˜**: Line 520-562 (`get_config()`, `apply_config()`)

**ë³€ê²½ ì‚¬í•­ 1: get_config() ìˆ˜ì •**

```python
# Line 520-533
def get_config(self) -> dict:
    """í˜„ì¬ ì„¤ì • ë°˜í™˜"""
    return {
        'exchange': self.exchange_combo.currentText() if self.exchange_combo else 'bybit',
        'watch_count': self.watch_spin.value() if self.watch_spin else 50,
        'max_positions': self.max_pos_spin.value() if self.max_pos_spin else 1,
        'leverage': self.leverage_spin.value() if self.leverage_spin else 10,
        # âŒ ì œê±°
        # 'seed': self.seed_spin.value() if self.seed_spin else 100.0,
        # âœ… ë³€ê²½
        'initial_capital': self.initial_capital_spin.value() if self.initial_capital_spin else 100.0,
        'capital_mode': 'compound' if (self.mode_combo and self.mode_combo.currentIndex() == 0) else 'fixed'
    }
```

**ë³€ê²½ ì‚¬í•­ 2: apply_config() ìˆ˜ì •**

```python
# Line 535-562
def apply_config(self, config: dict):
    """ì„¤ì • ì ìš© (ë°±í…ŒìŠ¤íŠ¸ â†’ ì‹¤ì‹œê°„ ë³µì‚¬ìš©)

    Args:
        config: {'exchange': ..., 'leverage': ..., 'initial_capital': ...}
    """
    if self.exchange_combo and 'exchange' in config:
        idx = self.exchange_combo.findText(config['exchange'])
        if idx >= 0:
            self.exchange_combo.setCurrentIndex(idx)

    if self.watch_spin and 'watch_count' in config:
        self.watch_spin.setValue(config['watch_count'])

    if self.max_pos_spin and 'max_positions' in config:
        self.max_pos_spin.setValue(config['max_positions'])

    if self.leverage_spin and 'leverage' in config:
        self.leverage_spin.setValue(config['leverage'])

    # âŒ ì œê±°
    # if self.seed_spin and 'seed' in config:
    #     self.seed_spin.setValue(config['seed'])

    # âœ… ë³€ê²½
    if self.initial_capital_spin:
        # 'initial_capital' ë˜ëŠ” í•˜ìœ„ í˜¸í™˜ 'seed'
        capital = config.get('initial_capital', config.get('seed', 100.0))
        self.initial_capital_spin.setValue(capital)

    if self.mode_combo and 'capital_mode' in config:
        idx = 0 if config['capital_mode'] == 'compound' else 1
        self.mode_combo.setCurrentIndex(idx)

    logger.info(f"[LiveMulti] ì„¤ì • ì ìš©: {config}")
```

---

## âœ… ê²€ì¦ ê³„íš

### Phase 1 ê²€ì¦ (UI êµ¬ì¡°)

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**:
1. Modern UI ì‹¤í–‰: `python run_gui.py`
2. "ğŸš€ Live Trading" íƒ­ í´ë¦­
3. í™•ì¸:
   - âœ… "ì´ˆê¸° ìë³¸:" í•„ë“œ ì¡´ì¬ (ìˆ˜ì • ê°€ëŠ¥)
   - âœ… "í˜„ì¬ ì”ì•¡:" ë¼ë²¨ ì¡´ì¬ (ì½ê¸° ì „ìš©, ğŸ”’ ì•„ì´ì½˜)
   - âœ… ì´ˆê¸°ê°’ ë‘˜ ë‹¤ $100.00

### Phase 2 ê²€ì¦ (ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸)

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**:
1. ì´ˆê¸° ìë³¸ $100 ì„¤ì •
2. ë³µë¦¬ ëª¨ë“œ ì„ íƒ
3. "â–¶ Start Trading" ë²„íŠ¼ í´ë¦­
4. í™•ì¸:
   - âœ… ì´ˆê¸° ìë³¸ í•„ë“œ ì ê¹€ (ìˆ˜ì • ë¶ˆê°€)
   - âœ… í˜„ì¬ ì”ì•¡ $100.00 í‘œì‹œ
5. ê±°ë˜ ì™„ë£Œ í›„ (ìˆ˜ìµ +$10):
   - âœ… í˜„ì¬ ì”ì•¡ $110.00ìœ¼ë¡œ ì—…ë°ì´íŠ¸ (ì´ˆë¡ìƒ‰)
   - âœ… íˆ´íŒ: "ë‹¤ìŒ ê±°ë˜ í¬ê¸°: $110.00, ëˆ„ì  ì†ìµ: +$10.00"
6. "â–  Stop Trading" ë²„íŠ¼ í´ë¦­
7. í™•ì¸:
   - âœ… ì´ˆê¸° ìë³¸ í•„ë“œ ì ê¸ˆ í•´ì œ (ìˆ˜ì • ê°€ëŠ¥)

### Phase 3 ê²€ì¦ (ë³µë¦¬/ê³ ì • ëª¨ë“œ)

**ë³µë¦¬ ëª¨ë“œ í…ŒìŠ¤íŠ¸**:
1. ì´ˆê¸° ìë³¸ $100
2. ëª¨ë“œ: ğŸ“ˆ ë³µë¦¬ (Compound)
3. ê±°ë˜ 1: +$10 â†’ í˜„ì¬ ì”ì•¡ $110.00 âœ…
4. ê±°ë˜ 2: +$5 â†’ í˜„ì¬ ì”ì•¡ $115.00 âœ…

**ê³ ì • ëª¨ë“œ í…ŒìŠ¤íŠ¸**:
1. ì´ˆê¸° ìë³¸ $100
2. ëª¨ë“œ: ğŸ“Š ê³ ì • (Fixed)
3. ê±°ë˜ 1: +$10 â†’ ëˆ„ì  ì†ìµ +$10.00 âœ… (í˜„ì¬ ì”ì•¡ $110.00)
4. ê±°ë˜ 2: +$5 â†’ ëˆ„ì  ì†ìµ +$15.00 âœ… (í˜„ì¬ ì”ì•¡ $115.00)
5. í™•ì¸: ë‹¤ìŒ ê±°ë˜ í¬ê¸°ëŠ” $100 (ê³ ì •) âœ…

---

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: UI êµ¬ì¡° ë³€ê²½
- [ ] `initial_capital_spin` í•„ë“œ ì¶”ê°€ (QDoubleSpinBox)
- [ ] `current_balance_label` ë¼ë²¨ ì¶”ê°€ (QLabel, ì½ê¸° ì „ìš©)
- [ ] `self.seed_spin` ì œê±°
- [ ] í´ë˜ìŠ¤ ì†ì„± ì—…ë°ì´íŠ¸
- [ ] UI ë°°ì¹˜ í™•ì¸ (ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ)

### Phase 2: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- [ ] `balance_timer` ì´ˆê¸°í™” (QTimer)
- [ ] `_update_balance_display()` ë©”ì„œë“œ êµ¬í˜„
- [ ] `_on_balance_updated()` ìŠ¬ë¡¯ êµ¬í˜„
- [ ] `_start_trading()`: ì´ˆê¸° ìë³¸ ì ê¸ˆ + íƒ€ì´ë¨¸ ì‹œì‘
- [ ] `_stop_trading()`: ì´ˆê¸° ìë³¸ ì ê¸ˆ í•´ì œ + íƒ€ì´ë¨¸ ì¤‘ì§€

### Phase 3: ì„¤ì • ì €ì¥/ë¡œë“œ
- [ ] `get_config()`: 'seed' â†’ 'initial_capital' ë³€ê²½
- [ ] `apply_config()`: í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€ ('seed' fallback)
- [ ] ë³µë¦¬/ê³ ì • ëª¨ë“œë³„ í‘œì‹œ ë¡œì§ êµ¬í˜„

### ìµœì¢… ê²€ì¦
- [ ] Pyright ì—ëŸ¬ 0ê°œ í™•ì¸
- [ ] Modern UI ì‹¤í–‰ í…ŒìŠ¤íŠ¸
- [ ] ë³µë¦¬ ëª¨ë“œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ í™•ì¸
- [ ] ê³ ì • ëª¨ë“œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ í™•ì¸
- [ ] ë§¤ë§¤ ì‹œì‘/ì¤‘ì§€ ì‹œ ì ê¸ˆ ë™ì‘ í™•ì¸

---

## ğŸš€ ì‹¤í–‰ ìˆœì„œ

1. **Phase 1: UI êµ¬ì¡° ë³€ê²½** (30ë¶„)
   - `ui/widgets/trading/live_multi.py` ìˆ˜ì • (Line 108-224)
   - í…ŒìŠ¤íŠ¸: UI ë ˆì´ì•„ì›ƒ í™•ì¸

2. **Phase 2: ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸** (40ë¶„)
   - `ui/widgets/trading/live_multi.py` ìˆ˜ì • (Line 130, 324-350, 580+)
   - í…ŒìŠ¤íŠ¸: ë§¤ë§¤ ì‹œì‘ â†’ ê±°ë˜ ì™„ë£Œ â†’ ì”ì•¡ ì—…ë°ì´íŠ¸ í™•ì¸

3. **Phase 3: ì„¤ì • ì—…ë°ì´íŠ¸** (20ë¶„)
   - `ui/widgets/trading/live_multi.py` ìˆ˜ì • (Line 520-562)
   - í…ŒìŠ¤íŠ¸: ë°±í…ŒìŠ¤íŠ¸ â†’ ì‹¤ì‹œê°„ ë³µì‚¬ ê¸°ëŠ¥ í™•ì¸

**ì´ ì˜ˆìƒ ì‹œê°„**: 90ë¶„

---

## ğŸ“ ê´€ë ¨ íŒŒì¼

### ìˆ˜ì • ëŒ€ìƒ íŒŒì¼ (1ê°œ)
1. `ui/widgets/trading/live_multi.py` (587ì¤„ â†’ ~650ì¤„)
   - Line 108-112: í´ë˜ìŠ¤ ì†ì„± ì¶”ê°€
   - Line 130: íƒ€ì´ë¨¸ ì´ˆê¸°í™”
   - Line 209-224: UI êµ¬ì¡° ë³€ê²½ (ì´ˆê¸° ìë³¸ + í˜„ì¬ ì”ì•¡)
   - Line 324-350: ë§¤ë§¤ ì‹œì‘/ì¤‘ì§€ ë¡œì§ (ì ê¸ˆ + íƒ€ì´ë¨¸)
   - Line 520-562: ì„¤ì • ì €ì¥/ë¡œë“œ (initial_capital)
   - Line 580+: ì”ì•¡ ì—…ë°ì´íŠ¸ ë©”ì„œë“œ 2ê°œ ì¶”ê°€

### ì°¸ì¡° íŒŒì¼ (ì½ê¸° ì „ìš©)
- `core/capital_manager.py` (105ì¤„) - ìë³¸ ê´€ë¦¬ SSOT
- `core/unified_bot.py` (366-387ì¤„) - ìë™ ì—…ë°ì´íŠ¸
- `storage/trade_storage.py` (227ì¤„) - ê±°ë˜ ë‚´ì—­ ì¡°íšŒ
- `ui/design_system/tokens.py` - ë””ìì¸ í† í°

---

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼

1. **ì‚¬ìš©ì„± ê°œì„ ** (+100%)
   - ì‹¤ì‹œê°„ ì”ì•¡ í™•ì¸ ê°€ëŠ¥
   - ë³µë¦¬ íš¨ê³¼ ì‹¤ì‹œê°„ í™•ì¸

2. **UI/UX ê°œì„ ** (+80%)
   - ì½ê¸° ì „ìš© ë¼ë²¨ë¡œ ëª…í™•ì„± í–¥ìƒ
   - ìƒ‰ìƒ í”¼ë“œë°± (ì´ˆë¡/ë¹¨ê°•)
   - íˆ´íŒìœ¼ë¡œ ì¶”ê°€ ì •ë³´ ì œê³µ

3. **ë°ì´í„° ì •í™•ì„±** (+100%)
   - CapitalManagerì™€ UI ì™„ì „ ë™ê¸°í™”
   - 1ì´ˆë§ˆë‹¤ ìë™ ì—…ë°ì´íŠ¸

4. **ë³µë¦¬ íš¨ê³¼ ê°€ì‹œí™”** (+100%)
   - ìˆ˜ìµì´ ì¬íˆ¬ìë˜ëŠ” ê³¼ì • ì‹¤ì‹œê°„ í™•ì¸
   - ë³µë¦¬ì™€ ê³ ì • ëª¨ë“œ ì°¨ì´ ëª…í™•íˆ í‘œì‹œ

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **íƒ€ì´ë¨¸ ì˜¤ë²„í—¤ë“œ**
   - 1ì´ˆë§ˆë‹¤ ê±°ë˜ ë‚´ì—­ ì¡°íšŒ
   - ê²½ëŸ‰ ì‘ì—…ì´ì§€ë§Œ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í•„ìš”

2. **ìŠ¤ë ˆë“œ ì•ˆì „ì„±**
   - QTimerëŠ” ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰
   - `trade_storage.get_stats()`ëŠ” Lock ë³´í˜¸ë¨

3. **í•˜ìœ„ í˜¸í™˜ì„±**
   - 'seed' â†’ 'initial_capital' ë³€ê²½
   - `apply_config()`ì—ì„œ 'seed' fallback ìœ ì§€

4. **UnifiedBot ì¸ìŠ¤í„´ìŠ¤ ì°¸ì¡°**
   - í˜„ì¬ëŠ” í´ë§ ë°©ì‹ (ê±°ë˜ ë‚´ì—­ ì¡°íšŒ)
   - í–¥í›„: UnifiedBot ì¸ìŠ¤í„´ìŠ¤ ì§ì ‘ ì°¸ì¡°ë¡œ ê°œì„  ê°€ëŠ¥

---

## ğŸ“– ì°¸ê³  ë¬¸ì„œ

- `docs/CAPITAL_MODE_INSPECTION_20260120.md`: ìë³¸ ê´€ë¦¬ ì‹œìŠ¤í…œ ì¢…í•© ì ê²€
- `CLAUDE.md` v7.27: í”„ë¡œì íŠ¸ ê·œì¹™
- `ui/design_system/tokens.py`: ë””ìì¸ í† í° (Colors, Typography, Spacing)

---

**ì‘ì„±ì**: Claude Sonnet 4.5
**ê²€í† **: ì‚¬ìš©ì ìŠ¹ì¸ ëŒ€ê¸°
