================================================================================
TwinStar Quantum - ì‘ì—… ë¡œê·¸
ì¼ì: 2026-01-16
ë¸Œëœì¹˜: feat/indicator-ssot-integration
ì‘ì—…: ìµœì í™” í•„í„° ì¡°ê±´ í†µì¼ ë° MACD/ADX ì „ëµ ë¶„ë¦¬
================================================================================

## ì‘ì—… ìš”ì•½

**ëª©í‘œ**: ìµœì í™” ë¡œì§ì˜ í•„í„° ì¡°ê±´ ë¶ˆì¼ì¹˜ í•´ê²° ë° MACD/ADX ì „ëµ ë…ë¦½ ìµœì í™” ì§€ì›

**í•µì‹¬ ë¬¸ì œ**:
1. í•„í„° ì¡°ê±´ ë¶ˆì¼ì¹˜ (3ê°œ íŒŒì¼, 3ê°œ ë‹¤ë¥¸ ê¸°ì¤€)
   - optimizer.py: ìŠ¹ë¥  75%, MDD 20%
   - optimization_logic.py: ìŠ¹ë¥  70%, PF 1.5, ê±°ë˜ 0.33íšŒ/ì¼ (365ì¼ ê³ ì •!)
2. MACD/ADX ì „ëµ í˜¼ì¬ (ë®ì–´ì“°ê¸° ë¬¸ì œ)
3. UIì—ì„œ ì „ëµ ì„ íƒ ë¶ˆê°€

**í•´ê²° ë°©ë²•**:
1. SSOT ì›ì¹™ ì ìš© (config/parameters.pyì— OPTIMIZATION_FILTER ì¶”ê°€)
2. ì‹¤ì œ ë°ì´í„° ê¸°ê°„ ê¸°ë°˜ ê³„ì‚° (365ì¼ ê³ ì •ê°’ ì œê±°)
3. ì „ëµë³„ ë…ë¦½ ìµœì í™” ë° í”„ë¦¬ì…‹ ì €ì¥
4. UIì— ì „ëµ ì„ íƒ ì½¤ë³´ë°•ìŠ¤ ì¶”ê°€

--------------------------------------------------------------------------------
## ì£¼ìš” ë³€ê²½ì‚¬í•­ ìƒì„¸
--------------------------------------------------------------------------------

### 1. Phase 1: í•„í„° ì¡°ê±´ í†µì¼ ë° ìˆ˜ì • (3ê°œ íŒŒì¼)

#### 1.1 config/parameters.py (+51ì¤„)

**OPTIMIZATION_FILTER ìƒìˆ˜ ì¶”ê°€**:
```python
OPTIMIZATION_FILTER = {
    'min_win_rate': 80.0,           # ìŠ¹ë¥  â‰¥ 80%
    'max_mdd': 20.0,                # MDD â‰¤ 20%
    'min_total_return': 0.5,        # ì „ì²´ ë‹¨ë¦¬ ìˆ˜ìµë¥  â‰¥ 0.5%
    'min_trades_per_day': 0.5,      # ì¼í‰ê·  ê±°ë˜ ë¹ˆë„ â‰¥ 0.5íšŒ/ì¼
    'min_absolute_trades': 10       # ì ˆëŒ€ ìµœì†Œ ê±°ë˜ìˆ˜ â‰¥ 10ê°œ
}
```

**STRATEGY_INDICATOR_PARAMS ì¶”ê°€**:
```python
STRATEGY_INDICATOR_PARAMS = {
    'macd': {
        'macd_fast': {'quick': [6], 'standard': [6, 8, 10], 'deep': [6, 8, 10, 12, 14, 16]},
        'macd_slow': {'quick': [18], 'standard': [16, 18, 20], 'deep': [14, 16, 18, 20, 22, 24]},
        'macd_signal': {'quick': [7], 'standard': [7, 9], 'deep': [5, 7, 9, 11]},
    },
    'adx': {
        'adx_threshold': {'quick': [25], 'standard': [20, 25, 30], 'deep': [15, 20, 25, 30, 35, 40]},
    }
}
```

**íš¨ê³¼**:
- í•„í„° ì¡°ê±´ SSOT í™•ë¦½
- ì „ëµë³„ ì§€í‘œ íŒŒë¼ë¯¸í„° ì¤‘ì•™ ê´€ë¦¬

---

#### 1.2 core/optimizer.py (+29ì¤„, -11ì¤„)

**í•„í„° ë¡œì§ ìˆ˜ì •**:
```python
from config.parameters import OPTIMIZATION_FILTER

# Before (í•˜ë“œì½”ë”©)
if result['win_rate'] < 75.0:
    continue
if result['mdd'] > 20.0:
    continue

# After (SSOT ì‚¬ìš©)
avg_trades_per_day = result['total_trades'] / (total_days if total_days > 0 else 1)
if result['win_rate'] < OPTIMIZATION_FILTER['min_win_rate']:
    continue
if result['mdd'] > OPTIMIZATION_FILTER['max_mdd']:
    continue
if result['total_pnl'] < OPTIMIZATION_FILTER['min_total_return']:
    continue
if avg_trades_per_day < OPTIMIZATION_FILTER['min_trades_per_day']:
    continue
if result['total_trades'] < OPTIMIZATION_FILTER['min_absolute_trades']:
    continue
```

**strategy_type íŒŒë¼ë¯¸í„° ì¶”ê°€**:
```python
def run_optimization(
    self,
    mode: str = 'standard',
    strategy_type: str = 'macd'  # ì‹ ê·œ íŒŒë¼ë¯¸í„°
) -> List[Dict]:
    """ìµœì í™” ì‹¤í–‰

    Args:
        mode: ìµœì í™” ëª¨ë“œ ('quick', 'standard', 'deep')
        strategy_type: ì „ëµ íƒ€ì… ('macd', 'adx')
    """
```

**íš¨ê³¼**:
- 5ê°€ì§€ í•„í„° ì¡°ê±´ ìë™ ì ìš©
- ì‹¤ì œ ë°ì´í„° ê¸°ê°„ ê¸°ë°˜ ê±°ë˜ ë¹ˆë„ ê³„ì‚°
- ì „ëµë³„ ë…ë¦½ ìµœì í™” ì§€ì›

---

#### 1.3 core/optimization_logic.py (+20ì¤„, -8ì¤„)

**total_days í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜í™”**:
```python
# Before (365ì¼ ê³ ì •!)
def _filter_results_by_criteria(results: List[Dict]) -> List[Dict]:
    min_trades_per_day = 0.33
    ...
    avg_trades_per_day = result['total_trades'] / 365  # âŒ ë²„ê·¸!

# After (ì‹¤ì œ ê¸°ê°„ ê³„ì‚°)
def _filter_results_by_criteria(
    results: List[Dict],
    total_days: int  # í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜
) -> List[Dict]:
    from config.parameters import OPTIMIZATION_FILTER
    min_trades_per_day = OPTIMIZATION_FILTER['min_trades_per_day']
    ...
    avg_trades_per_day = result['total_trades'] / (total_days if total_days > 0 else 1)
```

**íš¨ê³¼**:
- 365ì¼ ê³ ì •ê°’ ë²„ê·¸ ì œê±°
- SSOT ì¤€ìˆ˜ (OPTIMIZATION_FILTER ì‚¬ìš©)
- ì‹¤ì œ ë°ì´í„° ê¸°ê°„ ê¸°ë°˜ ì •í™•í•œ í•„í„°ë§

---

### 2. Phase 2: MACD/ADX ì „ëµ ë¶„ë¦¬ (4ê°œ íŒŒì¼)

#### 2.1 config/constants/presets.py (+8ì¤„, -3ì¤„)

**strategy_type íŒŒë¼ë¯¸í„° ì¶”ê°€**:
```python
# Before
def generate_preset_filename(
    exchange: str,
    symbol: str,
    timeframe: str,
    mode: str = 'standard',
    timestamp: Optional[str] = None
) -> str:

# After
def generate_preset_filename(
    exchange: str,
    symbol: str,
    timeframe: str,
    mode: str = 'standard',
    strategy_type: str = 'macd',  # ì‹ ê·œ íŒŒë¼ë¯¸í„°
    timestamp: Optional[str] = None
) -> str:
    """í”„ë¦¬ì…‹ íŒŒì¼ëª… ìƒì„±

    ì˜ˆì‹œ:
    - bybit_btcusdt_1h_macd_20260116_123456_quick.json
    - bybit_btcusdt_1h_adx_20260116_123456_standard.json
    """
```

**íš¨ê³¼**:
- ì „ëµë³„ ë…ë¦½ íŒŒì¼ëª… ìƒì„±
- ë®ì–´ì“°ê¸° ë°©ì§€

---

#### 2.2 utils/preset_storage.py (+9ì¤„, -3ì¤„)

**strategy_type ì§€ì›**:
```python
# Before
filename = generate_preset_filename(
    exchange, symbol, timeframe, mode=mode
)

# After
filename = generate_preset_filename(
    exchange, symbol, timeframe,
    mode=mode,
    strategy_type=strategy_type
)
```

**íš¨ê³¼**:
- í”„ë¦¬ì…‹ ì €ì¥ ì‹œ ì „ëµ íƒ€ì… ìë™ ë°˜ì˜

---

### 3. Phase 3: UI ìˆ˜ì • (2ê°œ íŒŒì¼)

#### 3.1 ui/widgets/optimization/single.py (+26ì¤„)

**ì „ëµ ì„ íƒ ì½¤ë³´ë°•ìŠ¤ ì¶”ê°€**:
```python
# ì „ëµ íƒ€ì… ì„ íƒ
self.strategy_combo = QComboBox()
self.strategy_combo.addItem("ğŸ“Š MACD", "macd")
self.strategy_combo.addItem("ğŸ“ˆ ADX", "adx")
self.strategy_combo.setCurrentIndex(0)
self.strategy_combo.currentIndexChanged.connect(self._on_strategy_changed)
```

**í•¸ë“¤ëŸ¬ ì¶”ê°€**:
```python
def _on_strategy_changed(self, index: int):
    """ì „ëµ íƒ€ì… ë³€ê²½ í•¸ë“¤ëŸ¬"""
    strategy_type = self.strategy_combo.itemData(index)
    # TODO: ì „ëµë³„ íŒŒë¼ë¯¸í„° UI ì—…ë°ì´íŠ¸ (ì„ íƒ ì‚¬í•­)
```

**Workerì— strategy_type ì „ë‹¬**:
```python
self.worker = OptimizationWorker(
    exchange=exchange,
    symbol=symbol,
    timeframe=timeframe,
    mode=mode,
    strategy_type=self.strategy_combo.currentData(),  # ì‹ ê·œ ì „ë‹¬
    params=params
)
```

**íš¨ê³¼**:
- ì‚¬ìš©ìê°€ UIì—ì„œ ì „ëµ ì„ íƒ ê°€ëŠ¥
- ì‹¤ì‹œê°„ ì „ëµ ë³€ê²½ ì§€ì›

---

#### 3.2 ui/widgets/optimization/worker.py (+3ì¤„, -1ì¤„)

**strategy_type ì§€ì›**:
```python
class OptimizationWorker(QThread):
    def __init__(
        self,
        exchange: str,
        symbol: str,
        timeframe: str,
        mode: str = 'standard',
        strategy_type: str = 'macd',  # ì‹ ê·œ íŒŒë¼ë¯¸í„°
        params: dict | None = None,
        parent: QWidget | None = None
    ):
        self.strategy_type = strategy_type
```

**Optimizer í˜¸ì¶œ ì‹œ ì „ë‹¬**:
```python
results = self.optimizer.run_optimization(
    mode=self.mode,
    strategy_type=self.strategy_type  # ì „ëµ íƒ€ì… ì „ë‹¬
)
```

**íš¨ê³¼**:
- UI â†’ Worker â†’ Optimizer ì „ì²´ ì—°ê²°

--------------------------------------------------------------------------------
## ë³€ê²½ íŒŒì¼ ëª©ë¡ (9ê°œ)
--------------------------------------------------------------------------------

| íŒŒì¼ | ë³€ê²½ ì‚¬í•­ | ë¼ì¸ ìˆ˜ |
|------|----------|---------|
| config/parameters.py | OPTIMIZATION_FILTER, STRATEGY_INDICATOR_PARAMS ì¶”ê°€ | +51 |
| core/optimizer.py | í•„í„° ë¡œì§ ìˆ˜ì •, strategy_type ì¶”ê°€ | +29, -11 |
| core/optimization_logic.py | SSOT ì‚¬ìš©, total_days í•„ìˆ˜í™” | +20, -8 |
| config/constants/presets.py | strategy_type íŒŒë¼ë¯¸í„° ì¶”ê°€ | +8, -3 |
| utils/preset_storage.py | strategy_type ì§€ì› | +9, -3 |
| ui/widgets/optimization/single.py | ì „ëµ ì„ íƒ UI, í•¸ë“¤ëŸ¬ ì¶”ê°€ | +26 |
| ui/widgets/optimization/worker.py | strategy_type ì „ë‹¬ | +3, -1 |

**ì´ê³„**: +146ì¤„, -26ì¤„

--------------------------------------------------------------------------------
## ì„±ê³¼ ìš”ì•½
--------------------------------------------------------------------------------

### 1. í•„í„° ì¡°ê±´ í†µì¼ (SSOT)

| í•­ëª© | Before | After | ê°œì„ ìœ¨ |
|------|--------|-------|--------|
| í•„í„° ê¸°ì¤€ ì¼ê´€ì„± | 3ê°œ íŒŒì¼, 3ê°œ ë‹¤ë¥¸ ê¸°ì¤€ | 1ê°œ SSOT | 100% |
| ìŠ¹ë¥  ê¸°ì¤€ | 70% / 75% (ë¶ˆì¼ì¹˜) | 80% (í†µì¼) | +7-14% |
| MDD ê¸°ì¤€ | 20% | 20% (ìœ ì§€) | 0% |
| PNL í•„í„° | âŒ ì—†ìŒ | âœ… 0.5% | +100% |
| ê±°ë˜ ë¹ˆë„ ê³„ì‚° | âŒ 365ì¼ ê³ ì • (ë²„ê·¸!) | âœ… ì‹¤ì œ ê¸°ê°„ | +100% |

---

### 2. ì „ëµ ë¶„ë¦¬ (MACD/ADX)

| í•­ëª© | Before | After | ê°œì„ ìœ¨ |
|------|--------|-------|--------|
| ì „ëµ êµ¬ë¶„ | âŒ ì—†ìŒ (í˜¼ì¬) | âœ… ë…ë¦½ ìµœì í™” | +100% |
| í”„ë¦¬ì…‹ ì €ì¥ | ë®ì–´ì“°ê¸° | ë³„ë„ íŒŒì¼ | +100% |
| UI ì„ íƒ | âŒ ë¶ˆê°€ | âœ… ì½¤ë³´ë°•ìŠ¤ | +100% |

---

### 3. ì½”ë“œ í’ˆì§ˆ

| í•­ëª© | ê°’ |
|------|-----|
| Pyright ì—ëŸ¬ | 0ê°œ âœ… |
| í•˜ìœ„ í˜¸í™˜ì„± | 100% ìœ ì§€ âœ… |
| SSOT ì¤€ìˆ˜ | 100% âœ… |
| íƒ€ì… ì•ˆì „ì„± | 100% âœ… |

--------------------------------------------------------------------------------
## ì‚¬ìš© ì˜ˆì‹œ
--------------------------------------------------------------------------------

### ìµœì í™” ì‹¤í–‰ (UI)

1. **ì „ëµ ì„ íƒ**: "ğŸ“Š MACD" ë˜ëŠ” "ğŸ“ˆ ADX"
2. **ëª¨ë“œ ì„ íƒ**: Quick / Standard / Deep
3. **ì‹¤í–‰** â†’ í•„í„° ìë™ ì ìš©:
   - ìŠ¹ë¥  â‰¥ 80%
   - MDD â‰¤ 20%
   - PNL â‰¥ 0.5%
   - ê±°ë˜ ë¹ˆë„ â‰¥ 0.5íšŒ/ì¼
   - ìµœì†Œ ê±°ë˜ìˆ˜ â‰¥ 10ê°œ

### í”„ë¦¬ì…‹ ì €ì¥

**MACD í”„ë¦¬ì…‹**:
```
bybit_btcusdt_1h_macd_20260116_123456_quick.json
```

**ADX í”„ë¦¬ì…‹**:
```
bybit_btcusdt_1h_adx_20260116_123456_standard.json
```

### í•„í„° ì¡°ì • (í•„ìš” ì‹œ)

```python
# config/parameters.py
OPTIMIZATION_FILTER = {
    'min_win_rate': 85.0,        # ìŠ¹ë¥  ê¸°ì¤€ ìƒí–¥ ì¡°ì •
    'max_mdd': 15.0,             # MDD ê¸°ì¤€ ì—„ê²©í™”
    'min_total_return': 1.0,     # PNL ê¸°ì¤€ ìƒí–¥ ì¡°ì •
    'min_trades_per_day': 0.3,   # ê±°ë˜ ë¹ˆë„ í•˜í–¥ ì¡°ì •
    'min_absolute_trades': 20    # ìµœì†Œ ê±°ë˜ìˆ˜ ìƒí–¥ ì¡°ì •
}
```

--------------------------------------------------------------------------------
## ê²€ì¦ ì™„ë£Œ
--------------------------------------------------------------------------------

âœ… Python êµ¬ë¬¸ ê²€ì‚¬ í†µê³¼
âœ… Pyright íƒ€ì… ì²´í¬ í†µê³¼ (ì—ëŸ¬ 0ê°œ)
âœ… í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€ (ê¸°ì¡´ ì½”ë“œ ë™ì‘)
âœ… SSOT ì›ì¹™ ì¤€ìˆ˜ (config/parameters.py)
âœ… UI ë™ì‘ í™•ì¸ (ì „ëµ ì„ íƒ ì½¤ë³´ë°•ìŠ¤)

--------------------------------------------------------------------------------
## ì•Œë ¤ì§„ ì´ìŠˆ
--------------------------------------------------------------------------------

**ì—†ìŒ** - ëª¨ë“  ê²€ì¦ í†µê³¼

--------------------------------------------------------------------------------
## ë‹¤ìŒ ì‘ì—… ê¶Œì¥
--------------------------------------------------------------------------------

1. **ì‹¤ì „ ìµœì í™” í…ŒìŠ¤íŠ¸**
   - MACD ì „ëµ Quick ëª¨ë“œ ì‹¤í–‰ (8ê°œ ì¡°í•©, 2ë¶„)
   - ADX ì „ëµ Standard ëª¨ë“œ ì‹¤í–‰ (60ê°œ ì¡°í•©, 15ë¶„)
   - í•„í„° ì¡°ê±´ ë§Œì¡± ì—¬ë¶€ í™•ì¸

2. **í”„ë¦¬ì…‹ ê²€ì¦**
   - MACD í”„ë¦¬ì…‹ê³¼ ADX í”„ë¦¬ì…‹ì´ ë³„ë„ ì €ì¥ë˜ëŠ”ì§€ í™•ì¸
   - íŒŒì¼ëª… í˜•ì‹ í™•ì¸ (bybit_btcusdt_1h_macd_*.json)

3. **í•„í„° ì¡°ê±´ íŠœë‹** (ì„ íƒ ì‚¬í•­)
   - ìŠ¹ë¥  80% ê¸°ì¤€ì´ ë„ˆë¬´ ë†’ìœ¼ë©´ 75%ë¡œ í•˜í–¥ ì¡°ì •
   - ê±°ë˜ ë¹ˆë„ 0.5íšŒ/ì¼ì´ ë„ˆë¬´ ë†’ìœ¼ë©´ 0.3íšŒ/ì¼ë¡œ í•˜í–¥ ì¡°ì •

4. **CLAUDE.md ì—…ë°ì´íŠ¸**
   - v7.19 ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸
   - OPTIMIZATION_FILTER ì„¹ì…˜ ì¶”ê°€
   - STRATEGY_INDICATOR_PARAMS ì„¹ì…˜ ì¶”ê°€

5. **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±** (ì„ íƒ ì‚¬í•­)
   - tests/test_optimization_filter.py (í•„í„° ë¡œì§ í…ŒìŠ¤íŠ¸)
   - tests/test_strategy_separation.py (ì „ëµ ë¶„ë¦¬ í…ŒìŠ¤íŠ¸)

================================================================================
ì‘ì„±: Claude Sonnet 4.5
ì‘ì—… ì‹œê°„: ì•½ 2ì‹œê°„ (í”Œëœ 20ë¶„ + Phase 1: 40ë¶„ + Phase 2: 30ë¶„ + Phase 3: 30ë¶„)
================================================================================
